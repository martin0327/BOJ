# [Platinum IV] タクシー (Taxis) - 10043 

[문제 링크](https://www.acmicpc.net/problem/10043) 

### 성능 요약

메모리: 3744 KB, 시간: 604 ms

### 분류

너비 우선 탐색, 데이크스트라, 그래프 이론, 그래프 탐색, 최단 경로

### 제출 일자

2025년 8월 30일 10:59:42

### 문제 설명

<p>IOI 国は町 1 から町 N までの N 個の町からなり，町と町とは道路で結ばれている．IOI 国には K 本の道路があり，すべての道路は異なる 2 つの町を結んでいる．車は道路を双方向に自由に移動できるが，道路以外を通ってある町から別の町に行くことはできない．</p>

<p>IOI 国の町 1 に住む JOI 君は，町 N に住む祖母の家までタクシーで行くことにした．IOI 国にはタクシー会社 1 からタクシー会社 N までの N 個のタクシー会社がある．IOI 国のタクシー会社には次のような少々特殊な規則がある．</p>

<ul>
	<li>タクシー会社 i のタクシーには，町 i でのみ乗車できる．</li>
	<li>タクシー会社 i のタクシーの運賃は，利用した距離によらず Ci である．</li>
	<li>タクシー会社 i のタクシーは，乗車してから連続して最大 R<sub>i</sub> 本の道路しか通ることができない．</li>
</ul>

<p>たとえば R<sub>1</sub> = 2 の場合，町 1 からタクシー会社 1 のタクシーに乗車すると，最大 2 本の道路しか通ることができないため，道路を 3 本以上通るためには途中の町でタクシーを乗り換える必要がある．</p>

<p>JOI 君は町以外の地点でタクシーに乗ったりタクシーから降りたりすることはできない．また，タクシー以外の移動手段を用いることもできない．JOI 君が町 N に到達するために必要な運賃の合計の最小値を求めるプログラムを作成せよ．</p>

### 입력 

 <p>入力は 1 + N + K 行からなる．</p>

<p>1 行目には，2 つの整数 N, K (2 ≦ N ≦ 5000, N - 1 ≦ K ≦ 10000) が空白を区切りとして書かれている．これは，IOI 国が N 個の町からなることと，IOI 国の道路の本数が K 本であることを表す．</p>

<p>続く N 行のうちの i 行目 (1 ≦ i ≦ N) には，2 つの整数 Ci, Ri (1 ≦ Ci ≦ 10000, 1 ≦ Ri ≦ N) が空白を区切りとして書かれている．これは，タクシー会社 i のタクシーの運賃が Ci で，乗車してから連続して最大 Ri 本の道路しか通ることができないことを表す．</p>

<p>続く K 行のうちの j 行目 (1 ≦ j ≦ K) には，異なる 2 つの整数 A<sub>j</sub>, B<sub>j</sub> (1 ≦ A<sub>j</sub> ＜ B<sub>j</sub> ≦ N) が空白を区切りとして書かれている．これは，町 A<sub>j</sub> と町 B<sub>j</sub> との間に道路が存在することを表す．同じ (A<sub>j</sub>, B<sub>j</sub>) の組が 2 回以上書かれていることはない．</p>

<p>与えられる入力データにおいては，どの町から別のどの町へもタクシーを乗り継いで行くことができることが保証されている．</p>

### 출력 

 <p>JOI 君が町 1 から町 N まで行くのに必要な運賃の合計の最小値を表す整数を 1 行で出力せよ．</p>

