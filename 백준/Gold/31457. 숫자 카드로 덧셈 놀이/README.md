# [Gold III] 숫자 카드로 덧셈 놀이 - 31457 

[문제 링크](https://www.acmicpc.net/problem/31457) 

### 성능 요약

메모리: 3004 KB, 시간: 632 ms

### 분류

브루트포스 알고리즘, 구현, 정렬

### 제출 일자

2025년 2월 11일 16:18:00

### 문제 설명

<p>Albert는 <code>"0-9"</code> 사이의 숫자가 적힌 카드 $M$ 장과 '<code>+</code>' (덧셈 기호)가 적힌 카드를 이용하여 덧셈 놀이를 하고 있다. 편의상 길이가 $M$인 정수문자열 $X$를 이용하여 좌측부터 우측으로 놓인 숫자 카드들을 표현하자.</p>

<p>예를 들어 아래 그림처럼 $M = 4$ 장의 카드를 나열한 경우 $X = $<code>"2024"</code> 로 표현할 수 있다. Albert는 항상 인접한 숫자 카드 쌍 사이에 공백을 충분히 두어 덧셈 카드를 넣을 수 있도록 배열하는데, 아래 그림에서 이러한 "빈 칸"이 총 $M-1 = 3$ 개 임을 확인할 수 있다.</p>

<p style="text-align: center;"><img alt="" src="" style="width: 350px; height: 42px;"></p>

<p>Albert는 이제 각 빈칸에 덧셈 기호를 넣을지 말지 정하여 총 $2^{M-1} = 8$ 가지 다른 덧셈 공식을 얻을 수 있고, 아래 규칙에 따라 이 공식들을 정렬해보았다:</p>

<ul>
	<li>우선 두 공식의 덧셈의 결과값이 다른 경우 이를 오름차순으로 정렬한다.</li>
	<li>어떤 두 공식의 덧셈 결과값이 같은 경우, 두 공식이 최초로 달라지는 가장 좌측의 빈칸이 있을 때, 해당 빈칸에 덧셈 카드가 놓인 공식이 먼저 오도록 정렬한다</li>
</ul>

<p>이 방법으로 위와 같은 예제에서 8개의 공식을 정렬한 결과는 아래와 같다. 가령 3번째 공식과 4번째 공식의 첫 번째 빈칸은 서로 같지만, 두 번째 빈칸이 최초로 다른데 3번째 공식에는 덧셈 카드가 있으므로 정렬시 앞선다. 1번째와 2번째 공식도 같은 이유로 정렬시 순서가 정해진다.</p>

<p style="text-align: center;"><img alt="" src="" style="height: 347px; width: 400px;"></p>

<p>Albert의 놀이를 지켜보던 Bob은 아래와 같은 문제를 냈다:</p>

<ul>
	<li>우선 덧셈 카드를 활용하여 만들 수 있는 $2^{M-1}$개의 공식을 위의 방법대로 정렬한다.</li>
	<li>임의의 정수 $x$ 에 대하여, $S(x)$ 는 $x$ 번째 공식의 덧셈 결과 값이고 $P(x)$ 는 해당 공식에 사용된 덧셈 카드의 개수라 정의하자.</li>
	<li>길이가 $N$인 임의의 정수 배열 $V$에 대해, $W_s = \sum_{i} S(V_i)$ 와 $W_p = \sum_{i} P(V_i)$ 를 구해보자 (단, $1 \le V_i \le 2^{M-1}$).</li>
</ul>

<p>가령 위의 예제에서 $N = 4$이고 $V = [1, 3, 5, 7]$인 경우:</p>

<ul>
	<li>$W_s = S(1) + S(3) + S(5) + S(7) = 8 + 26 + 26 + 206 = 266$ 이고</li>
	<li>$W_p = P(1) + P(3) + P(5) + P(7) = 3 + 2 + 2 + 1 = 8$ 이다.</li>
</ul>

<p>입력으로 $N$, $X$, 그리고 $V$가 주어졌을 때, Albert를 도와 $W_s, W_p$ 값을 구해보자.</p>

### 입력 

 <p>입력 첫 줄에 테스트 케이스의 수 $T$가 주어진다.</p>

<p>각 테스트 케이스는 두 줄에 걸쳐 주어지는데 첫 번째 줄에 $N$과 정수 문자열 $X$가 공백으로 구분되어 주어진다. 이 때 문자열 $X$의 길이인 $M$은 유추 가능하므로 입력으로 주어지지 않는다. 둘째 줄에는 배열 $V$의 원소 $N$개의 정수가 공백으로 구분되어 주어진다.</p>

### 출력 

 <p>각 테스트 케이스의 정답인 $W_s, W_p$를 공백으로 구분하여 각 줄에 출력한다.</p>

